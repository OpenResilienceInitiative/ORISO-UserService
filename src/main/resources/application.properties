# ---------------- General ----------------
spring.application.name=user-service
spring.profiles.active=@activeSpringProfile@
spring.main.allow-bean-definition-overriding=true
spring.jpa.open-in-view=true
spring.jpa.hibernate.ddl-auto=none
spring.data.jpa.repositories.bootstrap-mode=default
spring.main.banner-mode=off
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration,org.springframework.boot.autoconfigure.data.mongo.MongoDataAutoConfiguration

# ---------------- Server ----------------
server.port=8082
server.host=http://localhost
app.base.url=http://localhost:8082

# Tomcat thread pool - Scaled for 5000 concurrent users
server.tomcat.threads.max=1000
server.tomcat.threads.min-spare=500
server.tomcat.max-connections=5000
server.tomcat.accept-count=1000
server.tomcat.connection-timeout=30000

# ---------------- CORS ----------------
registration.cors.allowed.origins=http://91.99.219.182:9001
registration.cors.allowed.paths=/service/users/askers/new

spring.web.locale=de_DE
spring.jackson.time-zone=Europe/Berlin

service.encryption.appkey=

# ---------------- User Workflows ----------------
user.account.deleteworkflow.cron=0 0 0 * * ?
user.anonymous.deleteworkflow.cron=0 0 * * * ?
user.anonymous.deleteworkflow.periodMinutes=2820
user.anonymous.deactivateworkflow.cron=0 0 * * * ?
user.anonymous.deactivateworkflow.periodMinutes=360
group.chat.deactivateworkflow.cron=0 0 * * * ?
group.chat.deactivateworkflow.periodMinutes=360

session.inactive.deleteWorkflow.enabled=false
session.inactive.deleteWorkflow.cron=0 0 2 * * ?
session.inactive.deleteWorkflow.check.days=30

user.registeredonly.deleteWorkflow.enabled=false
user.registeredonly.deleteWorkflow.cron=0 0 3 * * ?
user.registeredonly.deleteWorkflow.check.days=30
user.registeredonly.deleteWorkflow.afterSessionPurge.enabled=false

enquiry.open.notification.enabled=false
enquiry.open.notification.cron=0 7 * * * ?
enquiry.open.notification.check.hours=12

# ---------------- Identity Management ----------------
identity.email-dummy-suffix=@beratungcaritas.de
identity.technical-user.username=technical
identity.technical-user.password=technical
identity.error-message-duplicated-email=User exists with same email
identity.error-message-duplicated-username=User exists with same username
identity.openid-connect-url=${app.base.url}/auth/realms/online-beratung/protocol/openid-connect
identity.otp-url=${app.base.url}/auth/realms/online-beratung/otp-config
identity.otp-allowed-for-users=false
identity.otp-allowed-for-consultants=false
identity.otp-allowed-for-single-tenant-admins=false
identity.otp-allowed-for-restricted-agency-admins=false
identity.otp-allowed-for-tenant-super-admins=false
identity.display-name-allowed-for-consultants=false

# ---------------- API Docs ----------------
springfox.docuTitle=Caritas Online Beratung: UserService
springfox.docuDescription=Provides a REST API service to provide user information and actions.
springfox.docuVersion=0.0.1
springfox.docuTermsUrl=
springfox.docuContactName=
springfox.docuContactUrl=
springfox.docuContactEmail=
springfox.docuLicense=Apache 2.0
springfox.docuLicenseUrl=http://www.apache.org/licenses/LICENSE-2.0.html
springfox.docuPath=/users/docs

# ---------------- Rocket.Chat ----------------
rocket-chat.credential-cron=0 0 * * * ?
rocket-chat.base-url=http://localhost:3000/api/v1
rocket-chat.mongo-url=mongodb://localhost:27017/rocketchat?retryWrites=false
rocket.technical.username=rocket-chat-technical-user
rocket.technical.password=technical

# ---------------- App Service URLs ----------------
agency.service.api.url=${app.base.url}/service
agency.service.api.get.agencies=${agency.service.api.url}/
agency.admin.service.api.url=${app.base.url}
consulting.type.service.api.url=http://localhost:8083
live.service.api.url=${app.base.url}/service/liveevent
appointment.service.api.url=
tenant.service.api.url=http://localhost:8081

# ---------------- File import ----------------
consultant.import.filename=consultants.csv
consultant.import.protocol.filename=consultants-import.txt
asker.import.filename=askers.csv
asker.import.withoutsession.filename=askers-without-session.csv
asker.import.protocol.filename=askers-import.txt
asker.import.welcome.message.filename=welcome_consulting_type_[ConsultingType].txt
asker.import.welcome.message.filename.replace.value=[ConsultingType]

# ---------------- Firebase ----------------
firebase.configuration.push-notifications.enabled=false
firebase.configuration.credentials.file.path=/firebase/firebase-credentials.json
firebase.configuration.notification.message=Du hast eine neue Nachricht erhalten

# ---------------- Cache ----------------
cache.agencies.configuration.maxEntriesLocalHeap=100
cache.agencies.configuration.eternal=false
cache.agencies.configuration.timeToIdleSeconds=0
cache.agencies.configuration.timeToLiveSeconds=10800

cache.consulting.type.configuration.maxEntriesLocalHeap=100
cache.consulting.type.configuration.eternal=false
cache.consulting.type.configuration.timeToIdleSeconds=0
cache.consulting.type.configuration.timeToLiveSeconds=86400

cache.tenant.configuration.maxEntriesLocalHeap=100
cache.tenant.configuration.eternal=false
cache.tenant.configuration.timeToIdleSeconds=0
cache.tenant.configuration.timeToLiveSeconds=86400

cache.topic.configuration.maxEntriesLocalHeap=100
cache.topic.configuration.eternal=false
cache.topic.configuration.timeToIdleSeconds=0
cache.topic.configuration.timeToLiveSeconds=60

cache.appsettings.configuration.maxEntriesLocalHeap=100
cache.appsettings.configuration.eternal=false
cache.appsettings.configuration.timeToIdleSeconds=0
cache.appsettings.configuration.timeToLiveSeconds=60

cache.rocketchat.configuration.maxEntriesLocalHeap=100
cache.rocketchat.configuration.eternal=false
cache.rocketchat.configuration.timeToIdleSeconds=0
cache.rocketchat.configuration.timeToLiveSeconds=900

# ---------------- Mail / Messaging ----------------
mail.service.api.url=http://mailservice:8080/service
message.service.api.url=http://messageservice:8080/service

# ---------------- Thread / Task Executor ----------------
# Scaled for 5000 concurrent users
thread.executor.corePoolSize=250
thread.executor.maxPoolSize=500
thread.executor.queueCapacity=10000
thread.executor.threadNamePrefix=UserService-

# ---------------- CSRF ----------------
csrf.header.property=X-CSRF-Token
csrf.whitelist.adminUris=/useradmin,/service/useradmin,/service/useradmin/,/service/useradmin/**,/useradmin/tenantadmins,/service/useradmin/tenantadmins,/service/useradmin/tenantadmins/,/service/useradmin/tenantadmins/**
csrf.whitelist.configUris=/users/docs,\
  /users/docs/**,\
  /v2/api-docs,\
  /configuration/ui,\
  /swagger-resources/**,\
  /configuration/security,\
  /swagger-ui.html,\
  /actuator/health/**,\
  /actuator/health,\
  /actuator/loggers/**,\
  /actuator/loggers,\
  /webjars/**,\
  /matrix/sync/**
csrf.cookie.property=CSRF-TOKEN
csrf.whitelist.header.property=X-CSRF-Bypass

# ---------------- RabbitMQ ----------------
spring.rabbitmq.host=localhost
spring.rabbitmq.port=5672
spring.rabbitmq.username=rabbit
spring.rabbitmq.password=rabbit
statistics.enabled=false
statistics.rabbitmq.exchange.name=statistics.topic

# ---------------- Video Chat ----------------
videochat.e2e-encryption-enabled=false

# ---------------- Multitenancy ----------------
multitenancy.enabled=false
spring.jpa.properties.hibernate.ejb.interceptor=de.caritas.cob.userservice.api.service.TenantHibernateInterceptor
hibernate.current_session_context_class=org.hibernate.context.internal.ThreadLocalSessionContext

# ---------------- Appointments & Features ----------------
appointments.delete-job-cron=0 0 0 * * ?
appointments.delete-job-enabled=false
appointments.lifespan-in-hours=24
feature.topics.enabled=false
feature.demographics.enabled=false
feature.appointment.enabled=false
feature.multitenancy.with.single.domain.enabled=false

# ---------------- Actuator ----------------
management.endpoint.health.enabled=true
management.endpoint.health.show-details=always
management.endpoints.web.exposure.include=health,loggers
management.endpoint.health.probes.enabled=true
management.endpoint.loggers.enabled=true

# ---------------- Zipkin / Sleuth ----------------
spring.zipkin.baseUrl=
spring.sleuth.sampler.percentage=1.0
spring.zipkin.sender.type=web

# ---------------- Local Defaults ----------------
anonymous.username.prefix=anon_

# Matrix Synapse Configuration
matrix.apiUrl=http://localhost:8008
matrix.registrationSharedSecret=caritas-registration-secret-2025
matrix.serverName=caritas.local
